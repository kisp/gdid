pkgname=gdid
pkgver=0.0.8
pkgrel=1
arch=('i686' 'x86_64')
makedepends=('sbcl')
options=(!strip)
source=(http://pauldist.kisp.in/archive/${pkgname}-${pkgver}.tgz
        http://beta.quicklisp.org/archive/alexandria/2014-07-13/alexandria-20140713-git.tgz
        http://beta.quicklisp.org/archive/cl-pdf/2013-11-11/cl-pdf-20131111-git.tgz
        http://beta.quicklisp.org/archive/cl-ppcre/2014-02-11/cl-ppcre-2.0.7.tgz
        http://beta.quicklisp.org/archive/cl-typesetting/2013-04-20/cl-typesetting-20130420-git.tgz
        http://beta.quicklisp.org/archive/closer-mop/2014-07-13/closer-mop-20140713-git.tgz
        http://pauldist.kisp.in/archive/hgetopt-0.0.3.tgz
        http://beta.quicklisp.org/archive/iterate/2014-07-13/iterate-20140713-darcs.tgz
        http://beta.quicklisp.org/archive/toadstool/2013-06-15/toadstool-20130615-git.tgz
        http://beta.quicklisp.org/archive/zpb-ttf/2013-07-20/zpb-ttf-1.0.3.tgz)
md5sums=('826c0941b9695febbd77ea17003a9983'
         '892cae0f69516f5aca7baa86905f98c4'
         '5fac0fd01c350fe359e9a908331b10a1'
         '950a9aab9c4dd9e1577869b05b0993f6'
         '10e0d45f5924c75f1d9f412cd4de8ac8'
         'bef4b7b11330aa8e75de678c5aafc322'
         '39c8398919bafa81d39dc51026ee7d31'
         'f3d8e9eb6a9241bb1303c9708a37ade4'
         '8bd093fb81edf56821b538339c70c1f1'
         '1e896d8b0b01babab882e43fe4c3c2d4')

prepare() {
    cd "$srcdir/$pkgname-$pkgver"
    mkdir asd
    ( ls -1 ../*/*.asd | xargs -I% bash -c 'ln -s ../% asd/`basename %`' )
}

build() {
    export PORTAGE_BUILD_USER=1
    cd "$srcdir/$pkgname-$pkgver"
    ./configure --prefix=/usr
    make
}

package() {
    cd "$srcdir/$pkgname-$pkgver"
    make DESTDIR="$pkgdir/" install
}
